\section{Introduction}

Powder X-ray diffraction (PXRD) is the most widely available probe for characterizing crystalline intermediates, yet turning a noisy one-dimensional scattering profile into an atomic structure still hinges on manual Rietveld-style refinement, curated priors, and hours of expert iteration~\cite{toby2013gsas2,rodriguezcarvajal1993fullprof,Cheetham2014}. Fully autonomous PXRD workflows therefore require models that can translate raw intensities into crystallographic information files (CIFs) while remaining faithful to experimental noise and instrument effects.

Autoregressive language models conditioned on PXRD embeddings (\eg, \deCIFer~\cite{deCIFer2025}) have taken important steps in this direction by directly generating CIF tokens from diffraction traces. However, the baseline exposed three systemic bottlenecks: (i) multi-day training due to inefficient data serving and augmentation, (ii) a single decoding rule that selects candidates solely by language-model likelihood, without a separate PXRD-based scoring step, and (iii) ad hoc evaluation of candidate CIF portfolios when chemical composition or symmetry descriptors are missing.

We introduce \xtoCIF, a practitioner-oriented extension that revisits training, decoding, and evaluation for PXRD-to-structure models. The framework accelerates data loading and PXRD augmentation, exposes scriptable deterministic beam search alongside the default stochastic sampler, and provides utilities that order candidate CIFs by their post hoc weighted-profile residual (\(\Rwp\)). Collectively, these changes enable systematic comparison across descriptor‑free, composition-conditioned, and composition‑plus‑space‑group regimes without altering the underlying autoregressive architecture or tokenizer.

On the NOMA benchmark, the proposed training stack delivers \(\sim44\times\) higher throughput while maintaining fidelity to experimental artifacts, and the decoding protocol improves both match rate (MR) and \(\Rwp\) in low-information settings. For comparability, we retain the MR, validity, and \(\Rwp\) metrics established by \deCIFer and report all ablations in the same evaluation harness.


\paragraph{Contributions.} Relative to \deCIFer, \xtoCIF keeps the autoregressive generator and tokenizer unchanged. We contribute three self-contained, quantified components:
\begin{itemize}
  \item \textbf{Training system (engineering).} A GPU-optimized pipeline that delivers \(\sim\!44\times\) higher throughput on NOMA via streamlined data serving, efficient PXRD augmentation, and multi-GPU orchestration. Single-GPU iteration time drops from \(257.9\!\pm\!4.2\) s to \(10.35\!\pm\!0.13\) s, and to \(5.82\!\pm\!0.19\) s on 2 GPUs (\(124\!\pm\!2\) and \(220\!\pm\!7\) samples/s respectively), reducing wall-clock training time by roughly \(44\times\) for a fixed step budget (Table~\ref{tab:train-optimization-throughput}). This acceleration allowed us to sweep dozens of random seeds and initialization strategies, raising the composition-conditioned MR to \(\approx97\%\) without modifying the \deCIFer backbone (Table~\ref{tab:decoding_refinements}); the original \deCIFer report lists \(\approx94\%\) for this regime~\cite{deCIFer2025}.
  \item \textbf{Inference protocol.} We expose deterministic beam search alongside the stochastic sampler and make it easy to sweep beam widths through the shared evaluation harness. Candidates are subsequently ordered by their computed \(\Rwp\) using the same utilities, which enables post hoc filtering of the beam without modifying checkpoints. In the descriptor‑free regime on NOMA this workflow reduces \(\Rwp\) from 0.23 to 0.18 and raises match rate (MR) from 5.6\% to 8.1\% (\(+45\%\) relative); with Comp or Comp+SG, \xtoCIF keeps MR near 97.3\% while trimming \(\Rwp\) by \(\sim0.03\) (Tab.~\ref{tab:decoding_refinements}).
  \item \textbf{Evaluation protocol.} A unified, reproducible protocol across three conditioning regimes (\emph{No descriptors} / \emph{Comp} / \emph{Comp+SG}) with standardized metrics: \emph{Validity} (syntax/unit-cell parameters/bond sanity), \emph{MR} (RMSD \(\le 0.5\,\text{\AA}\) after symmetry-aware alignment that enforces chemical identity), and \(\Rwp\) computed on simulated PXRD. Unless stated otherwise, we report aggregated statistics over generated candidates (best-of-beam extracted via the post hoc filtering stage plus global medians/means). Fig.~\ref{fig:beam_rmsd_match} shows how these aggregates evolve with beam size.
\end{itemize}

\input{Figures/fig_xtocif_overview}
